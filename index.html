<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Agendamento Avaliação Física Vila Império</title>

<style>

body{
font-family:Arial;
margin:0;
background:#f4f6f8;
}

header{
background:#fff;
padding:20px;
text-align:center;
box-shadow:0 2px 5px rgba(0,0,0,0.1);
}

header.compacto{
padding:8px;
font-size:14px;
}

header img{
max-width:140px;
}

header.compacto img{
max-width:60px;
}

.container{
padding:20px;
}

button{
padding:10px 15px;
margin:5px;
border:none;
border-radius:6px;
cursor:pointer;
background:#1e88e5;
color:#fff;
}

button:hover{
background:#1565c0;
}

.card{
background:#fff;
padding:15px;
margin:10px 0;
border-radius:8px;
box-shadow:0 2px 4px rgba(0,0,0,0.1);
}

.status{
padding:4px 8px;
border-radius:4px;
color:#fff;
display:inline-block;
margin-top:5px;
}

.pendente{background:gray;}
.mensagem{background:orange;}
.confirmado{background:#1e88e5;}
.realizado{background:green;}
.faltou{background:red;}
.bloqueado{background:red;}
.treinamento{background:purple;}

.hidden{
display:none;
}

.calendario{
display:grid;
grid-template-columns:repeat(7,1fr);
gap:5px;
}

.dia{
background:#fff;
padding:10px;
text-align:center;
cursor:pointer;
border-radius:6px;
}

.dia:hover{
background:#e3f2fd;
}

</style>

</head>
<body>

<header id="header">

<img src="logo-panobianco.png">

<h2>Agendamento Avaliação Física Vila Império</h2>

<div id="ano"></div>

</header>

<div class="container">

<div id="home">

<button onclick="loginAdmin()">Admin</button>

<button onclick="loginRecepcao()">Recepção</button>

<button onclick="loginProfessor()">Professores</button>

</div>

<div id="painel" class="hidden">

<button onclick="abrirAgendamento()">Novo Agendamento</button>

<button onclick="abrirBloqueioDia()">Bloquear Dia</button>

<button onclick="abrirBloqueioHorario()">Bloquear Horário</button>

<button onclick="logout()">Sair</button>

<div id="agenda"></div>

</div>

<div id="calendarioBox" class="hidden">

<button onclick="voltarMes()">◀</button>

<span id="mesAno"></span>

<button onclick="proximoMes()">▶</button>

<div class="calendario" id="calendario"></div>

</div>

</div>

<script>

let usuarioTipo="";
let usuarioAtual="";

let agendamentos=
JSON.parse(localStorage.getItem("agendamentos")||"[]");

let mesAtual=new Date().getMonth();
let anoAtual=new Date().getFullYear();

document.getElementById("ano").innerText=
"Ano: "+anoAtual;

function salvar(){

localStorage.setItem("agendamentos",
JSON.stringify(agendamentos));

}

function ativarHeaderCompacto(){

document.getElementById("header")
.classList.add("compacto");

}

function loginAdmin(){

let senha=prompt("Senha Admin:");

if(senha==="696907"){

usuarioTipo="admin";

usuarioAtual="Admin";

abrirPainel();

}

}

function loginRecepcao(){

let nome=prompt("Nome:");

let senha=prompt("Senha:");

usuarioTipo="recepcao";

usuarioAtual=nome;

abrirPainel();

}

function loginProfessor(){

usuarioTipo="professor";

usuarioAtual="Professor";

abrirPainel();

}

function abrirPainel(){

ativarHeaderCompacto();

document.getElementById("home")
.classList.add("hidden");

document.getElementById("painel")
.classList.remove("hidden");

renderAgenda();

}

function logout(){

location.reload();

}

function renderAgenda(){

let div=document.getElementById("agenda");

div.innerHTML="";

agendamentos.sort((a,b)=>{

return new Date(a.data+" "+a.hora)
-
new Date(b.data+" "+b.hora);

});

agendamentos.forEach(a=>{

let card=document.createElement("div");

card.className="card";

card.innerHTML=`

<b>${a.data} ${a.hora}</b><br>

<strong>${a.nome}</strong>

(ID: ${a.id})<br>

<span class="status ${a.status}">
${a.status}
</span><br>

Criado por: ${a.usuario}<br>

${usuarioTipo!=="professor"
?`<button onclick="cancelar('${a.uid}')">
Cancelar</button>`:""}

<button onclick="status('${a.uid}','realizado')">
Avaliação realizada</button>

<button onclick="status('${a.uid}','faltou')">
Faltou</button>

`;

div.appendChild(card);

});

}

function cancelar(uid){

if(!confirm("Cancelar agendamento?")) return;

agendamentos=
agendamentos.filter(a=>a.uid!==uid);

salvar();

renderAgenda();

}

function status(uid,s){

let a=agendamentos.find(x=>x.uid===uid);

if(a){

a.status=s;

salvar();

renderAgenda();

}

}

function abrirAgendamento(){

document.getElementById("calendarioBox")
.classList.remove("hidden");

renderCalendario();

}

function renderCalendario(){

let cal=document.getElementById("calendario");

cal.innerHTML="";

document.getElementById("mesAno").innerText=
mesAtual+1+"/"+anoAtual;

let dias=
new Date(anoAtual,mesAtual+1,0).getDate();

for(let i=1;i<=dias;i++){

let d=document.createElement("div");

d.className="dia";

d.innerText=i;

d.onclick=()=>selecionarDia(i);

cal.appendChild(d);

}

}

function selecionarDia(d){

let data=
anoAtual+"-"+(mesAtual+1)+"-"+d;

let hora=prompt("Hora:");

let nome=prompt("Nome:");

let id=prompt("ID:");

if(agendamentos.find(a=>a.id===id
&& a.nome!==nome)){

alert("ID já pertence a outro aluno");

return;

}

agendamentos.push({

uid:Date.now(),

data,

hora,

nome,

id,

status:"pendente",

usuario:usuarioAtual

});

salvar();

renderAgenda();

}

function voltarMes(){

mesAtual--;

if(mesAtual<0){

mesAtual=11;

anoAtual--;

}

renderCalendario();

}

function proximoMes(){

mesAtual++;

if(mesAtual>11){

mesAtual=0;

anoAtual++;

}

renderCalendario();

}

</script>

</body>
</html>
